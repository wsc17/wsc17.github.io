<!DOCTYPE html>
<html lang="en-us">

<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="theme-color" content="#494f5c">
<meta name="msapplication-TileColor" content="#494f5c">
<meta itemprop="name" content="微信公众号开发入门">
<meta itemprop="description" content="微信公众号开发入门"><meta itemprop="datePublished" content="2024-07-23T10:36:52+08:00" />
<meta itemprop="dateModified" content="2024-07-23T16:55:02+08:00" />
<meta itemprop="wordCount" content="87">
<meta itemprop="keywords" content="wechat-mp,openId,token," /><meta property="og:title" content="微信公众号开发入门" />
<meta property="og:description" content="微信公众号开发入门" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://wsc17.github.io/posts/wechat/wechat-mp/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-07-23T10:36:52+08:00" />
<meta property="article:modified_time" content="2024-07-23T16:55:02+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="微信公众号开发入门"/>
<meta name="twitter:description" content="微信公众号开发入门"/>

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
<link rel="shortcut icon" href="/favicon.ico"><title>微信公众号开发入门</title>
<link rel="stylesheet" href="https://wsc17.github.io/css/style.min.2372f32ce2a23df002ef53bd50f891aa44160be19fe56daf9df576cf9b1acce1.css" integrity="sha256-I3LzLOKiPfAC71O9UPiRqkQWC+Gf5W2vnfV2z5sazOE=" crossorigin="anonymous">
	
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://wsc17.github.io">Wushuchao | Blog</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					
				<a href="https://wsc17.github.io/posts/">文章</a>
				<a href="https://wsc17.github.io/about-hugo/">About</a>

				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<button id="toc-btn" class="hdr-btn desktop-only-ib" title="Table of Contents"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-list"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3" y2="6"></line><line x1="3" y1="12" x2="3" y2="12"></line><line x1="3" y1="18" x2="3" y2="18"></line></svg></button><span class="hdr-social hide-in-mobile"><a href="https://gitee.com/wuzuchao/wuzuchao" target="_blank" rel="noopener me" title="Gitee"><svg t="1700445689956" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11872" width="22" height="22"><path d="M978.467 409.614H455.101v0.011a45.51 45.51 0 0 0-45.51 45.499l-0.046 113.775a45.51 45.51 0 0 0 45.51 45.521l318.617-0.01a45.51 45.51 0 0 1 45.51 45.51v22.754c0 75.4-61.132 136.53-136.53 136.53h-432.38a45.51 45.51 0 0 1-45.51-45.51V341.35h-0.012c0-75.4 61.12-136.53 136.53-136.53h637.062v-0.024a45.51 45.51 0 0 0 45.51-45.487l0.102-113.775h0.023A45.51 45.51 0 0 0 978.467 0L341.326 0.023C152.823 0.023 0 152.846 0 341.349v637.14A45.51 45.51 0 0 0 45.51 1024h671.274c169.662 0 307.193-137.532 307.193-307.193V455.124a45.51 45.51 0 0 0-45.51-45.51z" fill="#ffffff" p-id="11873" data-spm-anchor-id="a313x.search_index.0.i57.70183a81pvKA1A" class="selected"></path></svg></a></span><button id="share-btn" class="hdr-btn" title="Share"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-share-2"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg></button>
 
<div id="share-links" class="animated fast">
    
    
    
    
    <ul>
        <li>
            <a href="https://twitter.com/intent/tweet?hashtags=hermit2&amp;url=https%3a%2f%2fwsc17.github.io%2fposts%2fwechat%2fwechat-mp%2f&amp;text=%e5%be%ae%e4%bf%a1%e5%85%ac%e4%bc%97%e5%8f%b7%e5%bc%80%e5%8f%91%e5%85%a5%e9%97%a8" target="_blank" rel="noopener" aria-label="Share on X"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path class="st0" d="m21.3 21.1 -11.4 -18.2h-7.2l11.4 18.2zm-18.6 0 7.2 -6.6m4.2 -5 7.2 -6.6"/></svg></a>
        </li>
        <li>
            <a href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fwsc17.github.io%2fposts%2fwechat%2fwechat-mp%2f" target="_blank" rel="noopener" aria-label="Share on Facebook"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg></a>
        </li>
        <li>
            <a href="mailto:?subject=%e5%be%ae%e4%bf%a1%e5%85%ac%e4%bc%97%e5%8f%b7%e5%bc%80%e5%8f%91%e5%85%a5%e9%97%a8&amp;body=https%3a%2f%2fwsc17.github.io%2fposts%2fwechat%2fwechat-mp%2f" target="_self" rel="noopener" aria-label="Share on Email"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a>
        </li>
        <li>
            <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwsc17.github.io%2fposts%2fwechat%2fwechat-mp%2f&amp;source=https%3a%2f%2fwsc17.github.io&amp;title=%e5%be%ae%e4%bf%a1%e5%85%ac%e4%bc%97%e5%8f%b7%e5%bc%80%e5%8f%91%e5%85%a5%e9%97%a8&amp;summary=%e5%be%ae%e4%bf%a1%e5%85%ac%e4%bc%97%e5%8f%b7%e5%bc%80%e5%8f%91%e5%85%a5%e9%97%a8%2c%20by%20wushuchao%0a%0a%e5%be%ae%e4%bf%a1%e5%85%ac%e4%bc%97%e5%8f%b7%e5%bc%80%e5%8f%91%e5%85%a5%e9%97%a8%0a" target="_blank" rel="noopener" aria-label="Share on LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg></a>
        </li>
    </ul>
</div><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://wsc17.github.io/posts/">文章</a></li>
			<li><a href="https://wsc17.github.io/about-hugo/">About</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster"><article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Jul 23, 2024</span></div>
				<h1>微信公众号开发入门</h1>
			</header>
			<div class="post-info"><p>微信公众号开发入门</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-feather"><path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"></path><line x1="16" y1="8" x2="2" y2="22"></line><line x1="17.5" y1="15" x2="9" y2="15"></line></svg><a href="/about-hugo/" target="_blank">wushuchao</a></p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://wsc17.github.io/tags/wechat-mp">wechat-mp</a></span><span class="tag"><a href="https://wsc17.github.io/tags/openid">openId</a></span><span class="tag"><a href="https://wsc17.github.io/tags/token">token</a></span></p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>87 Words
    … ⏲ Reading Time:
    
    
    
    23 Seconds</p>
<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2024-07-23 10:36 &#43;0800&nbsp;[Modified : 2024-07-23 16:55 &#43;0800]</p></div>
			<hr class="post-end">
			<div class="content">
				<h1 id="一什么是微信开发者">一、什么是微信开发者<a href="#一什么是微信开发者" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<p>微信是什么，应该不用多说。</p>
<p>而微信开发者，指的是需要借助微信，来达到某些目的的人。</p>
<p>例，某公司需要开发一套公众号景区售票系统，让游客可以在微信公众号上来进行购票。此时，该公司或者公司的软件开发人员，即为微信开发者。</p>
<h1 id="二微信开放平台">二、微信开放平台<a href="#二微信开放平台" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<p>微信开放平台，是微信提供给开发者的开发帮助平台。</p>
<p>开发者可以在该平台上查阅相关资料，了解微信提供了哪些服务（例，服务号、订阅号、小程序），以及如何使用这些服务。</p>
<p>开放平台地址：<code>https://mp.weixin.qq.com</code>。</p>
<h1 id="三openid">三、openId<a href="#三openid" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<p>openId是指，用户在某个微信应用/服务下的唯一标识。</p>
<p>用户在不同的微信应用/服务下，会有不同的openId。</p>
<p>openId的唯一：微信应用/服务 + 用户。</p>
<p>即，每个用户在不同的微信应用/服务下，会有一个唯一标识。</p>
<p>微信开发者可以借助openId，来实现很多的业务功能。</p>
<h1 id="四公众号开发">四、公众号开发<a href="#四公众号开发" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h1>
<h2 id="一注册公众号">（一）注册公众号<a href="#一注册公众号" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>用户需要申请微信公众号，并进行认证等操作，才能正常使用公众号的功能。</p>
<h2 id="二公众号服务">（二）公众号服务<a href="#二公众号服务" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>微信公众号，主要提供两大类服务：消息会话和公众号内网页。</p>
<h2 id="三配置自定义菜单">（三）配置自定义菜单<a href="#三配置自定义菜单" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>通过配置自定义菜单，以公众号菜单为入口，实现用户在公众号内访问业务系统的页面。</p>
<ol>
<li>
<p>公众号管理员登录微信公众平台（公众号）。</p>
</li>
<li>
<p>找到【内容与互动-自定义菜单】，即可添加菜单（发送消息、跳转网页、跳转小程序）。</p>
</li>
</ol>
<p>注：跳转网页的菜单，需要已认证的公众号才能随意添加外链。</p>
<h2 id="四消息会话">（四）消息会话<a href="#四消息会话" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>公众号是以微信用户的一个联系人形式存在的，用户可以跟公众号进行消息会话。</p>
<p>例，用户给公众号发送某个关键词，公众号会回复某些信息。</p>
<p>主要类型有：</p>
<ul>
<li>
<p>群发消息</p>
</li>
<li>
<p>被动回复</p>
</li>
<li>
<p>客服消息</p>
</li>
<li>
<p>模板消息。例，购票成功后，发送一条消息给用户，展示购票时间、金额等相关信息（通过定制消息模板的方式）。</p>
</li>
</ul>
<h2 id="五公众号内网页">（五）公众号内网页<a href="#五公众号内网页" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>当需要通过公众号进入某些系统自定义的页面时，就需要使用公众号内网页功能。</p>
<p>例，用户通过点击公众号的购票菜单，进入购票页面。</p>
<h3 id="1网页授权">（1）网页授权<a href="#1网页授权" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<ol>
<li>
<p>网页授权，是用户进入公众号内网页的第一个步骤，可以在这个步骤中，获取到用户信息。</p>
</li>
<li>
<p>网页授权分为：静默授权和非静默授权。</p>
<ul>
<li>
<p>静默授权：用户对授权无感知，不需要操作什么。这种方式只能获取到openId，无法获取用户的其它信息。</p>
</li>
<li>
<p>非静默授权：会弹出授权确认框，用户点击同意后，才能获取用户信息。这种方式能够获取到openId及用户的一些其它信息。</p>
</li>
</ul>
</li>
<li>
<p>网页授权结合业务系统，常规流程为：</p>
<ul>
<li>
<p>用户点击菜单，访问业务系统后端接口（<code>officialAccountsAuth</code>）。</p>
</li>
<li>
<p>业务系统后端在<code>officialAccountsAuth</code>接口中，构建重定向链接，跳转到网页授权（静默/非静默）界面。</p>
</li>
<li>
<p>用户同意授权后，将能够获取到微信<code>code</code>参数，然后继续访问业务系统另一个后端接口（<code>getOpenId</code>）。</p>
</li>
<li>
<p>业务系统后端在<code>getOpenId</code>接口中，使用<code>code</code>参数获取用户信息（比如<code>openId</code>），根据需要构建用户登录信息，然后携带登录信息重定向到业务系统页面（比如首页）。</p>
</li>
</ul>
<p><img src="/img/wechat/WECHAT_MP_LOGIN.jpg" alt="示例图片"></p>
</li>
</ol>
<h3 id="2业务流程">（2）业务流程<a href="#2业务流程" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<ol>
<li>
<p>管理员在微信公众号管理后台，配置一个自定义菜单。</p>
<p>菜单类型为跳转网页，网页链接设置为：业务系统的一个后端接口。</p>
<p>例，接口名称为<code>officialAccountsAuth</code>：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 1、菜单的网页链接示例（用户点击菜单后，将访问这个地址）</span>
</span></span><span style="display:flex;"><span>https:<span style="color:#75715e">//maitang.com/officialAccountsAuth?returnUrl=https://maitang.com/webpage/aaa-h5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 2、https://maitang.com/officialAccountsAuth，这是一个业务系统的后端接口</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 3、returnUrl=https://maitang.com/webpage/aaa-H5，在网页授权流程全部完成后，最终将要跳转的地址（比如业务系统的首页）</span>
</span></span></code></pre></div></li>
<li>
<p>后端在<code>officialAccountsAuth</code>接口中，构建一个重定向链接。</p>
<p>目的是为了触发用户授权，并获取一个微信的<code>code</code>参数：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// 1、构建的重定向链接示例</span>
</span></span><span style="display:flex;"><span>https:<span style="color:#75715e">//open.weixin.qq.com/connect/oauth2/authorize?appid=abcdefghijklmn&amp;redirect_uri=http%3A%2F%2F138.38.38.38%2Fapi%2Fc%2Foperation%2FbizWechat%2FgetOpenId&amp;response_type=code&amp;scope=snsapi_base&amp;state=http%3A%2F%2F4maitang.com%2Faaa-h5&amp;connect_redirect=1#wechat_redirect</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// a、appid：微信公众号的唯一标识</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// b、redirect_uri：用户授权完成后，后续将要跳转的地址。</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 这个地址也是一个业务系统后端接口（getOpenId），详情看下文</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// c、scope：静默/非静默授权，值为snsapi_base时表示静默授权</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// d、state：上文第2个步骤，officialAccountsAuth接口的入参</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// e、其它参数：固定的</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 参考：后端重定向示例（Controller层代码，使用@RestController注解时）</span>
</span></span><span style="display:flex;"><span>response.<span style="color:#a6e22e">sendRedirect</span>(redirectUrl);
</span></span></code></pre></div></li>
<li>
<p>在<code>officialAccountsAuth</code>接口中构建链接并重定向之后：</p>
<p>静默授权时：页面将直接访问上一步中的<code>redirect_uri（getOpenId）</code>。</p>
<p>非静默授权：页面弹出授权确认弹窗，用户点击同意后，继续访问上一步中的<code>redirect_uri（getOpenId）</code>。</p>
<p>注，此时的<code>redirect_uri</code>，将被微信在原来的基础上，自动拼接上一个<code>code</code>参数。</p>
</li>
<li>
<p>业务系统在上一步的<code>redirect_uri（getOpenId）</code>接口中：</p>
<ul>
<li>
<p>获取到<code>code</code>参数，然后用这个<code>code</code>参数获取微信的<code>accessToken</code>和<code>openId</code>。</p>
</li>
<li>
<p>获取到<code>openId</code>后，业务系统可以使用这个<code>openId</code>作为用户的唯一标识，为当前用户创建登录信息（比如<code>token</code>）。</p>
</li>
<li>
<p>将登录信息（比如<code>token</code>）拼接到上文第1步中的returnUrl这个链接上，然后进行重定向。</p>
</li>
<li>
<p>至此，完成了3大关键步骤：网页授权、获取openId、业务系统登录，并且携带业务系统登录信息跳转到业务系统的页面（比如首页），后续就可以正常进行业务交互。</p>
</li>
</ul>
</li>
</ol>

			</div>

		</article>
		<aside id="toc">
			<div class="toc-title">Table of Contents</div>
			<nav id="TableOfContents">
  <ul>
    <li><a href="#一注册公众号">（一）注册公众号</a></li>
    <li><a href="#二公众号服务">（二）公众号服务</a></li>
    <li><a href="#三配置自定义菜单">（三）配置自定义菜单</a></li>
    <li><a href="#四消息会话">（四）消息会话</a></li>
    <li><a href="#五公众号内网页">（五）公众号内网页</a>
      <ul>
        <li><a href="#1网页授权">（1）网页授权</a></li>
        <li><a href="#2业务流程">（2）业务流程</a></li>
      </ul>
    </li>
  </ul>
</nav>
		</aside>
		<div class="post-nav thin">
			<a class="prev-post" href="https://wsc17.github.io/posts/wow/wow/">
				<span class="post-nav-label">Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>游戏魔兽世界入门</span>
			</a>
		</div>
		<div id="comments" class="thin">
</div>
	</main>

<footer id="site-footer" class="section-inner thin animated fadeIn faster">
	<p>
		&copy; 2024 <a href="https://wsc17.github.io">wushuchao</a>
		&#183; blog
		&#183; Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a>
		&#183; Theme <a href="https://github.com/1bl4z3r/hermit-V2" target="_blank" rel="noopener">Hermit-V2</a>
		
		&#183; <a href="https://wsc17.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		
	</p>

</footer>

	
<a href="#" class="scroll-up"><svg xmlns="http://www.w3.org/2000/svg" fill="#3B3E48" width="64px" height="64px" viewBox="-2.4 -2.4 28.80 28.80" id="up-circle" data-name="Flat Color" xmlns="http://www.w3.org/2000/svg" class="icon flat-color" stroke="#3B3E48" stroke-width="0.00024000000000000003"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#CCCCCC" stroke-width="0.9600000000000002"><circle id="primary" cx="12" cy="12" r="10" style="fill: #3B3E48;"></circle><path id="secondary" d="M15,14a1,1,0,0,1-.71-.29L12,11.41l-2.29,2.3a1,1,0,0,1-1.42-1.42l3-3a1,1,0,0,1,1.42,0l3,3a1,1,0,0,1,0,1.42A1,1,0,0,1,15,14Z" style="fill: #018574;"></path></g><g id="SVGRepo_iconCarrier"><circle id="primary" cx="12" cy="12" r="10" style="fill: #3B3E48;"></circle><path id="secondary" d="M15,14a1,1,0,0,1-.71-.29L12,11.41l-2.29,2.3a1,1,0,0,1-1.42-1.42l3-3a1,1,0,0,1,1.42,0l3,3a1,1,0,0,1,0,1.42A1,1,0,0,1,15,14Z" style="fill: #018574;"></path></g></svg></a>
<noscript>
    <a href="#" class="scroll-up show"><svg xmlns="http://www.w3.org/2000/svg" fill="#3B3E48" width="64px" height="64px" viewBox="-2.4 -2.4 28.80 28.80" id="up-circle" data-name="Flat Color" xmlns="http://www.w3.org/2000/svg" class="icon flat-color" stroke="#3B3E48" stroke-width="0.00024000000000000003"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#CCCCCC" stroke-width="0.9600000000000002"><circle id="primary" cx="12" cy="12" r="10" style="fill: #3B3E48;"></circle><path id="secondary" d="M15,14a1,1,0,0,1-.71-.29L12,11.41l-2.29,2.3a1,1,0,0,1-1.42-1.42l3-3a1,1,0,0,1,1.42,0l3,3a1,1,0,0,1,0,1.42A1,1,0,0,1,15,14Z" style="fill: #018574;"></path></g><g id="SVGRepo_iconCarrier"><circle id="primary" cx="12" cy="12" r="10" style="fill: #3B3E48;"></circle><path id="secondary" d="M15,14a1,1,0,0,1-.71-.29L12,11.41l-2.29,2.3a1,1,0,0,1-1.42-1.42l3-3a1,1,0,0,1,1.42,0l3,3a1,1,0,0,1,0,1.42A1,1,0,0,1,15,14Z" style="fill: #018574;"></path></g></svg></a>
</noscript>
<script async src="https://wsc17.github.io/js/scrollwatcher.min.11bd2ce6f91dfb64095448b76ac1930124a42dc7133488e6d3d5aae7badaf562.js" integrity="sha256-Eb0s5vkd+2QJVEi3asGTASSkLccTNIjm09Wq57ra9WI=" crossorigin="anonymous"></script>

	<script async src="https://wsc17.github.io/js/bundle.min.038214de9d568246fadcfeb06c69349925de3209f332ec123861b6aa031d63c6.js" integrity="sha256-A4IU3p1Wgkb63P6wbGk0mSXeMgnzMuwSOGG2qgMdY8Y=" crossorigin="anonymous"></script>
	
	
	
</body>

</html>
